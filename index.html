<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Galactic RP Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

/* ================= PAGE ================= */

body{
margin:0;
font-family:Arial;
color:white;
background-image:url("static/background.jpg");
background-size:cover;
background-attachment:fixed;
background-color:#050814;
}

h2{
text-align:center;
margin:12px 0;
}

/* ================= MAP ================= */

#map-container{
position:relative;
width:100%;
max-width:1200px;
aspect-ratio:16/9;
margin:10px auto;
background:#081224;
border-radius:12px;
border:1px solid rgba(0,150,255,.4);
overflow:hidden;
cursor:grab;
touch-action:none;
}

/* GRID */

#map-container::before{
content:"";
position:absolute;
inset:0;
background-image:
linear-gradient(to right, rgba(0,150,255,.07) 1px, transparent 1px),
linear-gradient(to bottom, rgba(0,150,255,.07) 1px, transparent 1px);
background-size:50px 50px;
pointer-events:none;
z-index:1;
}

/* WORLD */

#map-world{
position:absolute;
width:100%;
height:100%;
transform-origin:center center;
z-index:2;
}

/* ================= PLANETS ================= */

.planet{
position:absolute;
transform:translate(-50%,-50%);
z-index:10;
width:25px;
height:25px;
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
}


/* DOT */

.dot{
width:12px;
height:12px;
border-radius:50%;
}

/* FACTIONS */

.republic .dot{background:#4db8ff;box-shadow:0 0 8px #4db8ff;}
.empire .dot{background:#ff2b2b;box-shadow:0 0 8px #ff2b2b;}
.neutral .dot{background:#ccc;box-shadow:0 0 6px #ccc;}
.pirates .dot{background:#9c27ff;box-shadow:0 0 6px #9c27ff;}
.mandalore .dot{background:#ff9800;box-shadow:0 0 8px #ff9800;}

/* LABEL */

.label{
margin-top:22px;
font-size:11px;
background:rgba(0,0,0,.7);
padding:3px 6px;
border-radius:5px;
white-space:nowrap;
pointer-events:none;
transform: translateY(10px);
}

/* ================= SHIPS ================= */

.ship-icon{
position:absolute;
left:50%;
top:50%;
width:18px;
pointer-events:none;
transform-origin:center;

filter:
drop-shadow(0 0 6px rgba(0,170,255,.8))
drop-shadow(0 0 12px rgba(0,170,255,.4));

animation:
orbit 6s linear infinite,
pulseGlow 2.5s ease-in-out infinite;
}

@keyframes orbit{
from{
transform:
translate(-50%,-50%)
rotate(calc(var(--i)*25deg))
translate(26px)
rotate(calc(var(--i)*-25deg));
}
to{
transform:
translate(-50%,-50%)
rotate(calc(var(--i)*25deg + 360deg))
translate(26px)
rotate(calc(var(--i)*-25deg - 360deg));
}
}

@keyframes pulseGlow{
0%{ filter: drop-shadow(0 0 4px rgba(0,170,255,.5)); }
50%{ filter: drop-shadow(0 0 10px rgba(0,170,255,.9)); }
100%{ filter: drop-shadow(0 0 4px rgba(0,170,255,.5)); }
}

/* CAPITAL SHIPS */

.capital-ship{
position:absolute;
left:50%;
top:50%;
width:36px;
pointer-events:none;

filter:
drop-shadow(0 0 6px rgba(0,170,255,.6))
drop-shadow(0 0 14px rgba(0,170,255,.4));

animation:
capitalOrbit 14s linear infinite,
capitalGlow 3s ease-in-out infinite;
}

@keyframes capitalOrbit{
from{
transform:
translate(-50%,-50%)
rotate(0deg)
translate(44px)
rotate(0deg);
}
to{
transform:
translate(-50%,-50%)
rotate(360deg)
translate(44px)
rotate(-360deg);
}
}

@keyframes capitalGlow{
0%{filter:drop-shadow(0 0 6px rgba(0,170,255,.4));}
50%{filter:drop-shadow(0 0 14px rgba(0,170,255,.9));}
100%{filter:drop-shadow(0 0 6px rgba(0,170,255,.4));}
}

/* ================= ROUTES ================= */
#routes-layer{
position:absolute;
width:100%;
height:100%;
pointer-events:none;
z-index:2;
}

.route-line{
stroke:rgba(0,170,255,.55);
stroke-width:0.35;
stroke-linecap:round;
vector-effect: non-scaling-stroke;
filter: drop-shadow(0 0 3px rgba(0,170,255,.6));
animation: routeGlow 3s ease-in-out infinite;
}

@keyframes routeGlow{
0%{opacity:.6;}
50%{opacity:1;}
100%{opacity:.6;}
}

/* ================= INFO ================= */

#info{
width:900px;
max-width:95vw;
margin:12px auto;
padding:12px;
background:linear-gradient(135deg,#0a2850,#06162f);
border-radius:12px;
border:1px solid rgba(0,150,255,.4);
}

.info-image{
width:100%;
max-height:220px;
object-fit:cover;
border-radius:8px;
margin-bottom:10px;
}

/* ================= ROUTE BUTTON ================= */

#route-toggle{
position:absolute;
top:10px;
right:10px;
padding:6px 12px;
background:#0a2a55;
border-radius:8px;
cursor:pointer;
border:1px solid rgba(0,150,255,.6);
z-index:10;
}

/* ================= MOBILE ================= */

@media (max-width: 768px){

.label{font-size:10px;}
.ship-icon{width:14px;}
.capital-ship{width:26px;}

}

</style>
</head>

<body>

<h2>Galactic RP Map</h2>

<div id="map-container">

<div id="route-toggle">Routes : ON</div>

<div id="map-world">
<svg id="routes-layer" viewBox="0 0 100 100" preserveAspectRatio="none"></svg>
</div>

</div>

<div id="info">Click on a planet</div>

<script>

/* ================= CAMERA ================= */

let scale=1,posX=0,posY=0;
let dragging=false,lastX=0,lastY=0;
let velocityX=0,velocityY=0,inertiaActive=false;

const world=document.getElementById("map-world");
const viewport=document.getElementById("map-container");
const routesSVG=document.getElementById("routes-layer");

function updateTransform(){
world.style.transform=`translate(${posX}px,${posY}px) scale(${scale})`;
}

/* ZOOM */

viewport.addEventListener("wheel",e=>{
e.preventDefault();
scale+=e.deltaY<0?0.1:-0.1;
scale=Math.max(.6,Math.min(2.5,scale));
updateTransform();
},{passive:false});

/* DRAG */

viewport.addEventListener("mousedown",e=>{
dragging=true;
inertiaActive=false;
lastX=e.clientX;
lastY=e.clientY;
velocityX=0;
velocityY=0;
});

window.addEventListener("mouseup",()=>{
dragging=false;
inertiaActive=true;
requestAnimationFrame(applyInertia);
});

window.addEventListener("mousemove",e=>{
if(!dragging)return;

const dx=e.clientX-lastX;
const dy=e.clientY-lastY;

posX+=dx;
posY+=dy;

velocityX=dx;
velocityY=dy;

lastX=e.clientX;
lastY=e.clientY;

updateTransform();
});

/* TOUCH */

viewport.addEventListener("touchstart",e=>{
dragging=true;
const t=e.touches[0];
lastX=t.clientX;
lastY=t.clientY;
},{passive:false});

viewport.addEventListener("touchmove",e=>{
if(!dragging)return;
e.preventDefault();

const t=e.touches[0];
const dx=t.clientX-lastX;
const dy=t.clientY-lastY;

posX+=dx;
posY+=dy;

velocityX=dx;
velocityY=dy;

lastX=t.clientX;
lastY=t.clientY;

updateTransform();
},{passive:false});

viewport.addEventListener("touchend",()=>{
dragging=false;
inertiaActive=true;
requestAnimationFrame(applyInertia);
});

/* INERTIA */

function applyInertia(){

if(!inertiaActive)return;

velocityX*=0.9;
velocityY*=0.9;

if(Math.abs(velocityX)<0.05 && Math.abs(velocityY)<0.05){
inertiaActive=false;
return;
}

posX+=velocityX;
posY+=velocityY;

updateTransform();
requestAnimationFrame(applyInertia);

}

/* ================= ROUTES ================= */

function drawRoute(a,b){

const line=document.createElementNS("http://www.w3.org/2000/svg","line");

line.setAttribute("x1",a.x);
line.setAttribute("y1",a.y);
line.setAttribute("x2",b.x);
line.setAttribute("y2",b.y);

line.classList.add("route-line");

routesSVG.appendChild(line);

}

function buildRoutes(){

routesSVG.innerHTML="";

const planets=document.querySelectorAll(".planet");
const points=[];

planets.forEach(p=>{
points.push({
x:parseFloat(p.style.left),
y:parseFloat(p.style.top)
});
});

const maxDist = 28;

/* MAIN NETWORK */

for(let i=0;i<points.length;i++){
for(let j=i+1;j<points.length;j++){

const dx=points[i].x-points[j].x;
const dy=points[i].y-points[j].y;
const dist=Math.hypot(dx,dy);

if(dist < maxDist){
drawRoute(points[i],points[j]);
}

}
}

/* FORCE CONNECTIVITY */

points.forEach((p,i)=>{

let nearest=null;
let best=Infinity;

points.forEach((q,j)=>{
if(i===j)return;

const d=Math.hypot(p.x-q.x,p.y-q.y);

if(d<best){
best=d;
nearest=q;
}
});

if(nearest){
drawRoute(p,nearest);
}

});

}

/* ================= SELECT ================= */

function selectPlanet(el){

const p=el.closest(".planet");

document.querySelectorAll(".planet").forEach(pl=>pl.classList.remove("selected"));
p.classList.add("selected");

const rect=viewport.getBoundingClientRect();

const px=parseFloat(p.style.left)/100*rect.width;
const py=parseFloat(p.style.top)/100*rect.height;

posX=(rect.width/2/scale)-px;
posY=(rect.height/2/scale)-py;

world.style.transition="transform .5s ease";
updateTransform();

setTimeout(()=>world.style.transition="",500);

/* INFO */

let img=p.dataset.image?`<img src="static/${p.dataset.image}" class="info-image">`:"";

let patrolHTML="";

if(p.dataset.patrolnames){
const names=p.dataset.patrolnames.split(";");
patrolHTML=`<hr><b>Patrol Units:</b><ul>${names.map(n=>`<li>${n}</li>`).join("")}</ul>`;
}

document.getElementById("info").innerHTML=`
${img}
<h3>${p.dataset.name}</h3>
<b>Faction:</b> ${p.dataset.faction}<br><br>
${p.dataset.desc}
${patrolHTML}
<br>
<a href="${p.dataset.wiki}" target="_blank">Open Wiki</a>
`;

}

/* ================= ROUTE TOGGLE ================= */

let routesVisible=true;

document.getElementById("route-toggle").onclick=()=>{

routesVisible=!routesVisible;
routesSVG.style.display=routesVisible?"block":"none";
document.getElementById("route-toggle").textContent=routesVisible?"Routes : ON":"Routes : OFF";

};

/* ================= LOAD DATA ================= */

fetch("./data.json")
.then(r=>r.json())
.then(planetes=>{

planetes.forEach(p=>{

const planet=document.createElement("div");

planet.className="planet "+p.Faction.toLowerCase();

planet.style.left=p.X+"%";
planet.style.top=p.Y+"%";

planet.dataset.name=p.Planete;
planet.dataset.faction=p.Faction;
planet.dataset.desc=p.Description;
planet.dataset.wiki=p.Wiki;
planet.dataset.image=p.Image||"";
planet.dataset.patrolnames=p.PatrolNames||"";

planet.innerHTML=`<div class="dot" onclick="selectPlanet(this)"></div>`;

/* PATROL */

for(let i=0;i<(p.PatrolCount||0);i++){
planet.innerHTML+=`<img src="static/patrol_ship.png" class="ship-icon" style="--i:${i}">`;
}

/* CAPITAL */

for(let i=0;i<(p.CapitalShip||0);i++){
planet.innerHTML+=`<img src="static/capital_ship.png" class="capital-ship">`;
}

/* LABEL */

planet.innerHTML+=`<div class="label">${p.Planete}</div>`;

world.appendChild(planet);

});

buildRoutes();

});

</script>

</body>
</html>




